<!DOCTYPE html>
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <script src="http://d3js.org/d3.v3.min.js"></script>
    </head>
    <body>
        <style>
        
        body {
          font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
          width: 960px;
          height: 500px;
          position: relative;
        }
        </style>
        <script>
			
			var timer;
			var updateStarted = false;
			var touches = [];
            
            var w = 0;
            var h = 0;
            var width = window.innerWidth;
            var height = window.innerHeight;
            
            if ((w != width) || (h != height)) {
            	w = width;
            	h = height;
            }
            
            
            var svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height);
            var circle = svg.selectAll("circle.touch");
                /*
            var toucheFunction=function(event){
                alert(event);
            };
            svg.on("touchstart",toucheFunction
            );
            svg.on("touchmove",toucheFunction
            );
            */
var circle = svg.selectAll("circle.touch");
            function touch() {
              d3.event.preventDefault();

              circle = circle
                  .data(d3.touches(svg.node()), function(d) { return d.identifier; });
            
              circle.exit()
                  .attr("class", null)
                  .remove();
            
            
              circle.enter().append("circle")
                  .attr("class", "touch")
                  .attr("r", 40).
                                attr("stroke", "black").
                                attr("fill", "grey");
            
            
              circle
                  .attr("cx", function(d) { return d[0]; })
                  .attr("cy", function(d) { return d[1]; });

            }             
            var transform= svg.append("g")
                .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(1)");
                			
            d3.select("body")
                .on("touchstart", touch)
                .on("touchmove", touch)
                .on("touchend", touch)
                .on("mousedown", touch);

    		function update() {
    			if (updateStarted) return;
    			updateStarted = true;
    		
    
                transform.selectAll(".touches").remove();
                transform.selectAll(".touches").
                    data(touches).
                    append("circle").
                    attr("r",10 ).
                    attr("rx", function(d) {
                        }).
                    attr("ry", function(d) {
                        }).
                    attr("class", "touches").
                    attr("stroke", "black").
                    attr("fill", "grey");
    			updateStarted = false;
    		}

    		timer = setInterval(update, 15);
        </script>        
    </body>
</html>
